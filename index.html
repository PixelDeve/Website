<!DOCTYPE html><html lang="en" class="scroll-smooth">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Spike ‚Äî The Next-Gen Social</title>
  <meta name="description" content="Spike - A beautiful, modern social platform better than Reddit." />  <!-- TailwindCSS CDN -->  <script src="https://cdn.tailwindcss.com"></script>  <script>
    tailwind.config = {
      theme: {
        extend: {
          colors: { primary: '#4f46e5', secondary: '#4338ca' }
        }
      }
    }
  </script>  <!-- Google Fonts: Poppins -->  <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;500;700&display=swap" rel="stylesheet" />
  <style>body { font-family: 'Poppins', sans-serif; background: linear-gradient(135deg, #4f46e5 0%, #4338ca 100%); min-height:100vh; color:#f9fafb; }</style>
</head>
<body class="flex flex-col min-h-screen">
  <!-- Navbar -->
  <nav class="bg-primary shadow-md sticky top-0 z-50">
    <div class="max-w-4xl mx-auto px-4 py-3 flex justify-between items-center">
      <a href="#" class="text-white text-2xl font-bold">Spike</a>
      <div class="flex items-center space-x-3">
        <p id="userDisplay" class="text-indigo-200"></p>
        <button id="loginBtn" class="bg-indigo-500 hover:bg-indigo-600 px-3 py-1 rounded">Sign In</button>
        <button id="logoutBtn" class="hidden bg-red-500 hover:bg-red-600 px-3 py-1 rounded">Sign Out</button>
      </div>
    </div>
  </nav>  <!-- Main -->  <main class="flex-grow max-w-4xl mx-auto p-4 space-y-6 w-full">
    <!-- New Post -->
    <div id="postForm" class="hidden bg-indigo-700 p-4 rounded-lg shadow-lg">
      <textarea id="postInput" rows="3" placeholder="What's on your mind?" class="w-full p-2 rounded bg-indigo-600 text-white"></textarea>
      <div class="mt-2 text-right">
        <button id="submitPost" class="bg-indigo-500 hover:bg-indigo-600 px-4 py-2 rounded">Post</button>
      </div>
    </div><!-- Feed -->
<div id="postFeed" class="space-y-6">
  <p class="text-center text-gray-300">Please log in to view posts.</p>
</div>

  </main>  <!-- Footer -->  <footer class="bg-primary py-4 text-center text-indigo-200">¬© 2025 Spike</footer>  <!-- Firebase SDK -->  <script type="module">
    import { initializeApp } from 'https://www.gstatic.com/firebasejs/11.9.0/firebase-app.js';
    import { getAuth, signInWithPopup, GoogleAuthProvider, signOut, onAuthStateChanged } from 'https://www.gstatic.com/firebasejs/11.9.0/firebase-auth.js';
    import { getFirestore, collection, addDoc, getDocs, query, orderBy, serverTimestamp, doc, updateDoc, deleteDoc } from 'https://www.gstatic.com/firebasejs/11.9.0/firebase-firestore.js';
    
    const firebaseConfig = { /* your config */ };
    const app = initializeApp(firebaseConfig);
    const auth = getAuth(app);
    const db = getFirestore(app);
    const provider = new GoogleAuthProvider();
    let currentUser = null;

    // Elements
    const loginBtn = document.getElementById('loginBtn');
    const logoutBtn = document.getElementById('logoutBtn');
    const userDisplay = document.getElementById('userDisplay');
    const postForm = document.getElementById('postForm');
    const postInput = document.getElementById('postInput');
    const submitPost = document.getElementById('submitPost');
    const postFeed = document.getElementById('postFeed');

    // Auth
    loginBtn.onclick = async () => { try { await signInWithPopup(auth, provider); } catch (e) { alert(e.message) }};
    logoutBtn.onclick = () => signOut(auth);
    onAuthStateChanged(auth, user => {
      currentUser = user;
      userDisplay.textContent = user ? `Hello, ${user.displayName}` : '';
      loginBtn.classList.toggle('hidden', !!user);
      logoutBtn.classList.toggle('hidden', !user);
      postForm.classList.toggle('hidden', !user);
      loadPosts();
    });

    // Load posts
    async function loadPosts() {
      postFeed.innerHTML = '';
      const q = query(collection(db, 'posts'), orderBy('createdAt', 'desc'));
      const snap = await getDocs(q);
      if (snap.empty) postFeed.innerHTML = '<p class="text-center text-gray-300">No posts yet.</p>';
      snap.forEach(docSnap => postFeed.append(createPostElement(docSnap.id, docSnap.data())));
    }

    function createPostElement(id, data) {
      const card = document.createElement('div');
      card.className = 'bg-indigo-700 p-4 rounded-lg shadow relative';
      // Content
      card.innerHTML = `
        <p class="text-white mb-2">${escape(data.content)}</p>
        <div class="text-gray-300 text-sm mb-2">by <strong>${escape(data.authorName)}</strong> ¬∑ ${data.createdAt?.seconds ? new Date(data.createdAt.seconds*1000).toLocaleString() : ''}</div>
        <div class="flex space-x-2 text-sm">
          <button class="upvoteBtn">‚ñ≤ ${data.upvotes||0}</button>
          <button class="toggleCommentsBtn">üí¨ ${data.commentsCount||0}</button>
        </div>
      `;
      // Owner controls
      if (currentUser.uid === data.authorId) {
        const ctrl = document.createElement('div'); ctrl.className='absolute top-2 right-2 flex space-x-1';
        ctrl.innerHTML = `<button data-id="${id}" class="editPost">‚úèÔ∏è</button><button data-id="${id}" class="delPost">üóëÔ∏è</button>`;
        card.append(ctrl);
      }
      // Events
      card.querySelector('.toggleCommentsBtn').onclick = () => toggleComments(id, card);
      card.querySelectorAll('.delPost').forEach(b=>b.onclick=()=>deletePost(b.dataset.id));
      card.querySelectorAll('.editPost').forEach(b=>editPost(id, data, card));
      card.querySelector('.upvoteBtn').onclick = () => upvote(id);
      return card;
    }

    // CRUD
    submitPost.onclick = async () => {
      if (!postInput.value.trim()) return;
      await addDoc(collection(db,'posts'),{ content:postInput.value, authorName:currentUser.displayName, authorId:currentUser.uid, createdAt:serverTimestamp(), upvotes:0, commentsCount:0 });
      postInput.value=''; loadPosts();
    };
    async function deletePost(id){ await deleteDoc(doc(db,'posts',id)); loadPosts(); }
    async function editPost(id,data,card){ card.innerHTML+=`<div class="mt-2"><textarea class="w-full p-2 rounded bg-indigo-600 text-white">${escape(data.content)}</textarea><button class="mt-1 bg-indigo-500 px-2 py-1 rounded">Save</button></div>`; card.querySelector('button').onclick=async()=>{ await updateDoc(doc(db,'posts',id),{content:card.querySelector('textarea').value}); loadPosts(); }}// upvote, comments logic omitted for brevity

function escape(str){ return str.replace(/[&<>"]/g,m=>({'&':'&amp;','<':'&lt;','>':'&gt;','"':'&quot;'}[m])); }

// Placeholder for comments/replies: implement toggleComments/upvote/etc.

  </script>
</body>
</html>
